<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Parity_RSA 二分法攻击 | Zedsich's Blog</title><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - 共 $1 行","copy":"复制","copyFinish":"复制成功","expand":"展开"}}</script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 5.4.2"></head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li><li class="navItem"><a class="navBlock" href="/contact/"><span class="navItemTitle">Contact</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>Parity_RSA 二分法攻击</h1><div id="post-info"><span>文章发布时间: <div class="control"><time datetime="2022-03-10T12:00:00.000Z" id="date"> 2022-03-10</time></div></span><br><span>最后更新时间: <div class="control"><time datetime="2023-03-10T15:54:51.193Z" id="updated"> 2023-03-10</time></div></span><br><span>文章总字数: <div class="control">1.1k</div></span><br><span>预计阅读时间: <div class="control">6 分钟</div></span></div></div><hr><div id="post-content"><h1 id="Parity-RSA"><a href="#Parity-RSA" class="headerlink" title="Parity_RSA"></a>Parity_RSA</h1><p><code>[QCTF] baby_rsa</code></p>
<h2 id="Analyze"><a href="#Analyze" class="headerlink" title="Analyze"></a>Analyze</h2><p>先看题：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><br>table = string.ascii_letters + string.digits<br>menu = <span class="hljs-string">b&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Give me your information and I&#x27;ll tell you about the parity after decryption.</span><br><span class="hljs-string">Let me see your options...</span><br><span class="hljs-string">1.encrypt message</span><br><span class="hljs-string">2.get flag</span><br><span class="hljs-string">3.exit</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>e = <span class="hljs-number">0x10001</span><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>N = p * q<br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = inverse(e, phi)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = self.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            self.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self, prompt=<span class="hljs-string">b&#x27;[-] &#x27;</span></span>):<br>        self.send(prompt, newline=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">return</span> self._recvall()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self</span>):<br>        proof = (<span class="hljs-string">&#x27;&#x27;</span>.join([random.choice(table) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>)])).encode()<br>        sha = sha256(proof).hexdigest().encode()<br>        self.send(<span class="hljs-string">b&quot;[+] sha256(XXXX+&quot;</span> + proof[<span class="hljs-number">4</span>:] + <span class="hljs-string">b&quot;) == &quot;</span> + sha)<br>        XXXX = self.recv(prompt=<span class="hljs-string">b&#x27;[+] Give Me XXXX :&#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(XXXX) != <span class="hljs-number">4</span> <span class="hljs-keyword">or</span> sha256(XXXX + proof[<span class="hljs-number">4</span>:]).hexdigest().encode() != sha:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-number">1</span>)<br>        signal.alarm(<span class="hljs-number">2400</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.proof_of_work():<br>            self.send(<span class="hljs-string">b&#x27;bye~&#x27;</span>)<br>            <span class="hljs-keyword">return</span><br><br>        self.send(menu)<br>        self.send((<span class="hljs-string">&#x27;e = &#x27;</span> + <span class="hljs-built_in">hex</span>(e)).encode())<br>        self.send((<span class="hljs-string">&#x27;N = &#x27;</span> + <span class="hljs-built_in">hex</span>(N)).encode())<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            num = self.recv(prompt=<span class="hljs-string">b&#x27;what\&#x27;s your choise?&#x27;</span>)<br>            <span class="hljs-keyword">if</span> num == <span class="hljs-string">b&#x27;1&#x27;</span>:<br>                c = <span class="hljs-built_in">int</span>(self.recv(prompt=<span class="hljs-string">b&#x27;the message:&#x27;</span>).decode(), <span class="hljs-number">16</span>)<br>                m = <span class="hljs-built_in">pow</span>(c, d, N)<br>                <span class="hljs-keyword">if</span> m % <span class="hljs-number">2</span>:<br>                    self.send(<span class="hljs-string">b&#x27;odd...&#x27;</span>)<br>                <span class="hljs-keyword">if</span> m % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>                    self.send(<span class="hljs-string">b&#x27;even...&#x27;</span>)<br>            <span class="hljs-keyword">elif</span> num == <span class="hljs-string">b&#x27;2&#x27;</span>:<br>                c = <span class="hljs-built_in">pow</span>(bytes_to_long(flag, e, N))<br>                self.send((<span class="hljs-string">&#x27;c = &#x27;</span> + <span class="hljs-built_in">hex</span>(c)).encode())<br>            <span class="hljs-keyword">elif</span> num == <span class="hljs-string">b&#x27;3&#x27;</span>:<br>                self.send(<span class="hljs-string">b&#x27;bye~&#x27;</span>)<br>                <span class="hljs-keyword">return</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span><br>        <br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">10000</span><br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    <span class="hljs-built_in">print</span>(HOST, PORT)<br>    server.serve_forever()<br><br></code></pre></td></tr></table></figure>

<p>先<code>nc</code>一下题目提供的端口：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">ncat scr1w.dlut.edu.cn <span class="hljs-number">28088</span><br><br><span class="hljs-comment">#Output:</span><br><span class="hljs-comment">#[+] sha256(XXXX+iemdocJd) == 419017b5ab02fca75dc806b09ce4bbec1fafe03292d5e17a54551cb2d00b7f40</span><br><span class="hljs-comment">#[+] Give Me XXXX :</span><br><br></code></pre></td></tr></table></figure>

<p>简单的sha256爆破：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">break_sha</span>(<span class="hljs-params">last, shav</span>):<br>    s = string.ascii_letters + string.digits<br>    <span class="hljs-keyword">for</span> v1 <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">for</span> v2 <span class="hljs-keyword">in</span> s:<br>            <span class="hljs-keyword">for</span> v3 <span class="hljs-keyword">in</span> s:<br>                <span class="hljs-keyword">for</span> v4 <span class="hljs-keyword">in</span> s:<br>                    t = (v1 + v2 + v3 + v4).encode() + last<br>                    <span class="hljs-keyword">if</span> sha256(t).hexdigest() == shav:<br>                        <span class="hljs-keyword">return</span> (v1 + v2 + v3 + v4).encode()<br>s1=<span class="hljs-string">b&#x27;iemdocJd&#x27;</span><br>s2=<span class="hljs-string">b&#x27;ee2571d3f23fb615fdbe01cea04a20352920f0b02c65e06fc14aa71cb20067e1&#x27;</span><br><span class="hljs-built_in">print</span>(break_sha(s1,s2.decode()))<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Output:</span><br><span class="hljs-comment">#Give me your information and I&#x27;ll tell you about the parity after decryption.</span><br><span class="hljs-comment">#Let me see your options...</span><br><span class="hljs-comment">#1.encrypt message</span><br><span class="hljs-comment">#2.get flag</span><br><span class="hljs-comment">#3.exit</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#e = 0x10001</span><br><span class="hljs-comment">#N = #0xab068236ae895f50991b85a495b05cab628f23408c6847aa19cb91e6b22e5b1a4e67d1c99b36f53da55230a26b496cb60a5092c728a24ffc0e5a195a456481f1e4c82512af6b8003e092045aa0b3dc79c4d12beea95729e6c1fce16215e0ef47d77bb3dc7417006a16af9b88841627c4462608af4e6d4fa8f369d126cf8bbad9</span><br><span class="hljs-comment">#what&#x27;s your choise?</span><br><br><span class="hljs-comment">#Input:</span><br><span class="hljs-comment">#2</span><br><br><span class="hljs-comment">#Output:</span><br><span class="hljs-comment">#c = 0x5fff63ca6bbf96b571128a2502bee3de7be1be0cb84e6f70c2750aaf174475335e0cb59a54a2811154b2c76dd01a2a05660b5485efbfc956d05f254b9fbac53644eea31ea59cc8a8782b4618558aeff0129d85d24dbc0adf431d0929a26803035cff7a2cbc7da52c4dee682078d46e15c2849898fa3defbc700c5878314ae646</span><br></code></pre></td></tr></table></figure>

<p>通过输入一个加密的密文，服务器会告诉你用私钥d解密该密文后，所得的明文结果是<code>even</code>还是<code>odd</code>，通过这种机制，我们可以向服务器传入的值进行一些修改操作，我们传入$2*e^{c}$ 即 为$(2m)^{e}$，而服务器会将$(2m)^e$解密成$2m$后告诉我们其模下的奇偶性。$2^{e}*c$即为$(2m)^{e}$，而服务器会将$(2m)^{e}$解密成$2m$后告诉我们其模下的奇偶性。$2^{e}$即为$(2m)^{e}$，而服务器会将$(2m)^{e}$解密成$2m$后告诉我们其模下的奇偶性。</p>
<p>我们知道任意一个自然数$m$,其与$2$的乘积一定为偶数，所以在$mod(m)$下：</p>
<p>若$2m&lt;n$，即解密后的传入参数没有经过取模操作的话,那么其奇偶性一定为<code>even</code>，因为$2m$为偶数</p>
<p>若$2m&gt;n$，即解密后的传入参数经过了取模操作，那么其奇偶性一定为<code>odd</code>，因为$2m$为偶数，$n$为奇数</p>
<p>根据上面两点我们可以得到以下结论：</p>
<p>若返回<code>even</code>，则$0&lt;2m&lt;n=&gt;0&lt;m&lt;\frac{2}{n}$</p>
<p>若返回<code>odd</code>，即$n&lt;2m&lt;2n=&gt;\frac{n}{2}&lt;m&lt;n$</p>
<p>通过返回的结果，我们可以将明文所在的缩小到原来范围的$\frac{1}{2}$，若我们继续传入$2^{2e}*c$，则可将范围再次缩小$\frac{1}{2}$</p>
<p>如此进行下去，我们只需要$log_{2}n$次即可得到$m$</p>
<hr>
<h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>e = <span class="hljs-number">0x10001</span><br>n = <span class="hljs-number">0x93022347fcf4a51c3a62dc83e93f4dc91dc6331b5541cd912fd7e0891a8419ce77fce50220cff791d9d7ca4f3af19531a3358a0301f85f284441a4ea9b38c84aa7901a11c9f6a5d6305933635294197d2f6cd63f9649ca9669a766e7f802a668d9b265d30fe8b657d369919ad278c52de26fac04e42f750999cce7dd6eb75a0f</span><br>c = <span class="hljs-number">0xec722e27f20c32794072fa699c7a657bee39134accd623166c785a8e44f22a5523274f68eda3c75a5117ddc9cc13fcfd611a4971530a6e6bf166b3cfdf7e92fd943c17d8b25990bfe24bc7718232789e4e2126b08d7117b4c90aa0702ef83d9cf98583f02c819676535e60c84f918dec8cd57a39dbf2d5a62924339cc00f665</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">break_sha</span>(<span class="hljs-params">last, shav</span>):<br>    s = string.ascii_letters + string.digits<br>    <span class="hljs-keyword">for</span> v1 <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">for</span> v2 <span class="hljs-keyword">in</span> s:<br>            <span class="hljs-keyword">for</span> v3 <span class="hljs-keyword">in</span> s:<br>                <span class="hljs-keyword">for</span> v4 <span class="hljs-keyword">in</span> s:<br>                    t = (v1 + v2 + v3 + v4).encode() + last<br>                    <span class="hljs-keyword">if</span> sha256(t).hexdigest() == shav:<br>                        <span class="hljs-keyword">return</span> (v1 + v2 + v3 + v4).encode()<br><br>ldata=<span class="hljs-number">0</span><br>rdata=n<br>num=<span class="hljs-number">0</span><br>io = remote(<span class="hljs-string">&quot;scr1w.dlut.edu.cn&quot;</span>, <span class="hljs-number">28092</span>)<br>io.recvuntil(<span class="hljs-string">b&#x27;sha256(XXXX+&#x27;</span>)<br>str1 = io.recvuntil(<span class="hljs-string">b&#x27;)&#x27;</span>, drop=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(str1)<br>io.recvuntil(<span class="hljs-string">b&#x27;== &#x27;</span>)<br>str2 = io.recvuntil(<span class="hljs-string">b&#x27;\n&#x27;</span>, drop=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(str2)<br>res = break_sha(str1, str2.decode())<br><span class="hljs-built_in">print</span>(res)<br>io.recvuntil(<span class="hljs-string">b&#x27;[+] Give Me XXXX :&#x27;</span>)<br>io.sendline(res)<br><br><span class="hljs-keyword">while</span> rdata-ldata&gt;<span class="hljs-number">2</span>:<br>    num+=<span class="hljs-number">1</span><br>    t=powmod(<span class="hljs-number">2</span>,num*e,n)<br>    data=<span class="hljs-built_in">hex</span>((c*t)%n)[<span class="hljs-number">2</span>:]<br><br>    io.recvuntil(<span class="hljs-string">b&quot;what&#x27;s your choise?&quot;</span>)<br>    io.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    <span class="hljs-comment"># io.recvuntil(b&#x27;the message:&#x27;)</span><br>    io.recv()<br>    io.sendline(data)<br>    ans=io.recvline()<br>    <span class="hljs-built_in">print</span>(ans)<br>    <span class="hljs-keyword">if</span> ans==<span class="hljs-string">b&#x27;odd...\n&#x27;</span>:<br>        ldata = (ldata + rdata) // <span class="hljs-number">2</span> <span class="hljs-keyword">if</span> (ldata + rdata) % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> (ldata + rdata) // <span class="hljs-number">2</span> + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span> ans==<span class="hljs-string">b&#x27;even...\n&#x27;</span>:<br>        rdata = (ldata + rdata) // <span class="hljs-number">2</span> <span class="hljs-keyword">if</span> (ldata + rdata) % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> (ldata + rdata) // <span class="hljs-number">2</span> + <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(rdata-ldata)<br>    <span class="hljs-comment"># print(ldata,rdata)</span><br><br><span class="hljs-comment"># while powmod(ldata,e,n)!=c:</span><br><span class="hljs-comment">#     ldata-=1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;l=&quot;</span>,ldata)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;r=&quot;</span>,rdata)<br><span class="hljs-built_in">print</span>(long_to_bytes(ldata))<br></code></pre></td></tr></table></figure>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/03/09/MySQL_1/">← Next 初见MySQL——基础篇</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2021/05/01/hello-world/">Hello World Prev →</a></div></div></div><details id="reward"><summary>打赏</summary><div><span>Alipay</span><br><img src="/img/Alipay.png"></div><div><span>Wechat</span><br><img src="/img/WeChat.png"></div></details><div id="comments"><div class="selector"><button class="valine-sel"></button></div><div id="valine"></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="文章目录">≡</a><a id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Zedsich</a></h1><div id="description"><p></p></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Parity-RSA"><span class="toc-number">1.</span> <span class="toc-text">Parity_RSA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analyze"><span class="toc-number">1.1.</span> <span class="toc-text">Analyze</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EXP"><span class="toc-number">1.2.</span> <span class="toc-text">EXP</span></a></li></ol></li></ol></div></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script class="pjax-js">reset=_=>{new Valine({
 el: '#valine'
 , appId: '12mmdjDQr3Zp2ZAH5T8u420K-gzGzoHsz'
 , appKey: 'B6NVCNzhi3ZWtXN73NUXFT3D' , placeholder: '此条评论委托企鹅物流发送'
 , path: window.location.pathname
});code.findCode();}</script><script src="/js/arknights.js"></script><script src="/js/pjax.js"></script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>